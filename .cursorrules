# Hyle: AI Assistant Context

**Project:** Hyle - Local-first D&D digital battlemap (Electron + React)
**Purpose:** This file provides context for AI coding assistants working on Hyle

## Quick Reference

**What is Hyle?** A dual-window Electron app for D&D Dungeon Masters. Projects a clean "World View" for players while the DM controls everything from an "Architect View."

**Tech Stack:**
- **Framework:** Electron 33 + React 18 + TypeScript 5
- **State:** Zustand (global store with subscriptions)
- **Canvas:** Konva/React-Konva (HTML5 Canvas wrapper)
- **Styling:** Tailwind CSS
- **Build:** Vite 6
- **Testing:** Vitest + React Testing Library

**Key Architecture:**
- Dual-window (Architect View + World View)
- IPC for state sync (Architect → World, one-way)
- Local-first (no cloud, `.hyle` ZIP files for campaigns)
- Privacy-focused error handling (PII sanitization)

## Project Structure

```
hyle/
├── electron/           # Main process (Node.js)
│   ├── main.ts        # Window creation, IPC handlers, file I/O
│   └── preload.ts     # Context bridge (secure IPC API)
├── src/               # Renderer process (React)
│   ├── components/    # React components
│   │   ├── Canvas/    # Konva canvas components
│   │   │   ├── CanvasManager.tsx      # Main canvas (viewport, camera, tools)
│   │   │   ├── GridOverlay.tsx        # Tactical grid (LINES/DOTS/HIDDEN)
│   │   │   └── TokenErrorBoundary.tsx # Per-token error isolation
│   │   ├── ImageCropper.tsx           # Token cropping UI
│   │   ├── Sidebar.tsx                # Map/grid controls + token library
│   │   ├── SyncManager.tsx            # IPC state sync manager
│   │   ├── Toast.tsx                  # Notification system
│   │   ├── PendingErrorsIndicator.tsx # Error reporting UI
│   │   └── PrivacyErrorBoundary.tsx   # App-wide error boundary
│   ├── store/         # Zustand state management
│   │   └── gameStore.ts  # Global game state (tokens, drawings, map, grid, toast)
│   ├── utils/         # Utility functions
│   │   ├── grid.ts              # Smart grid snapping
│   │   ├── AssetProcessor.ts    # Image optimization (WebP conversion)
│   │   ├── errorSanitizer.ts    # PII removal from errors
│   │   └── globalErrorHandler.ts # Global error catching
│   └── App.tsx        # Root component (Architect View)
└── docs/
    └── ERROR_BOUNDARIES.md  # Error handling architecture